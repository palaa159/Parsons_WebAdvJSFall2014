var app=app||{};app.main=function(){var e=document.getElementById("container"),t=function(e,t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){var e,a;4==i.readyState&&(e=i.status,200==e?(a=JSON.parse(i.responseText),t(a)):n(e))},i.send()},n={},i=function(e){n=e,console.log(e),o()},a=function(e){console.log(e)},o=function(){n.message[random(0,n.message.length-1)],n.medium[random(0,n.medium.length-1)],n.user[random(0,n.user.length-1)],n.problem[random(0,n.problem.length-1)];$(document).ready(function(){for(var t=0;12>t;t++)e.innerHTML=e.innerHTML+'<div class="keywordz" id="div'+t+'">'+n.message[random(0,n.message.length-1)]+"</div>"})},s=[],r={},c=function(){$(this.container).off("click").on("click",d),$("#itemAddBtn").off("click").on("click",l),$(document).off("keypress").on("keypress",function(e){$("#itemInput").focus(),13==e.which&&l()}),$(".itemFavorite").off("click").on("click",function(){var e=$(this).parent();s.forEach(function(t,n){t.view.item[0]===e[0]&&s[n].model.update(n)})}),$(".itemDelete").off("click").on("click",function(){var e=$(this).parent();s.forEach(function(t,n){t.view.item[0]===e[0]&&s[n].model.remove(n)})}),$(".item").off("dblclick").on("dblclick",function(){$(this).append("hey")})},d=function(){var e=$("#div0").text();console.log(this),new m(e,!1).add(),f(),c(),console.log("it happened")},l=function(){var e=$("#itemInput").val();e.length>2?(new m(e,!1).add(),$("#itemInput").val(""),f(),c()):alert("3 characters up pls.")},f=function(){console.info("rendering"),$("#itemsContainer").empty(),s.forEach(function(e,t){e.model.render(t)})},m=function(e,t){return this.item={title:e,fav:t},this.add=function(){r.model=this,new p(this).add(),u.save()},this.render=function(e){s[e].view.render(),u.save()},this.update=function(e){this.item.fav=!this.item.fav,s[e].view.update(),u.save()},this.remove=function(e){s[e].view.remove(),s.splice(e,1),u.save()},this},p=function(e){return this.item=null,this.add=function(){var t,n=$("<div></div>").addClass("item").hide();t=e.item.fav?$("<span>&#10084;</span>").addClass("itemFavorite fav").appendTo(n):$("<span>&#10084;</span>").addClass("itemFavorite").appendTo(n);$("<span></span>").addClass("itemTitle").html(e.item.title).appendTo(n),$("<span>&times;</span>").addClass("itemDelete").appendTo(n);this.item=n,r.view=this,s.unshift(r),r={}},this.update=function(){this.item.children(".itemFavorite").toggleClass("fav")},this.render=function(){$("#itemsContainer").append(this.item),this.item.fadeIn()},this.remove=function(){this.item.fadeOut()},this},u={load:function(){if(0===localStorage.length){var e=JSON.stringify([]);localStorage.setItem("app",e)}else{var t=JSON.parse(localStorage.getItem("app"));t.forEach(function(e){new m(e.title,e.fav).add()})}},save:function(){var e=[];s.forEach(function(t){e.unshift({title:t.model.item.title,fav:t.model.item.fav})}),localStorage.setItem("app",JSON.stringify(e))}},h=function(){console.info("app init"),t("data/wtf.json",i,a),u.load(),f(),c()};return{init:h,items:s}}(),$(window).on("load",app.main.init);var random=function(e,t){return Math.floor(Math.random()*t+e)};