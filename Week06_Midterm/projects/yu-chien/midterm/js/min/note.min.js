var app=app||{};app.todo=function(){var t=[],e={},i={load:function(){var t=JSON.parse(localStorage.getItem("todo"));console.log(t),null===t?localStorage.setItem("todo","[]"):t.forEach(function(t){new l(t.title,t.fav).create()})},save:function(){var e=[];t.forEach(function(t){e.unshift({title:t.model.item.title,fav:t.model.item.fav})}),localStorage.setItem("todo",JSON.stringify(e))}},n=function(){$("#itemAddBtn").off("click").on("click",s),$(document).off("keypress").on("keypress",function(t){$("#itemInput").focus(),13==t.which&&app.todo.addNewItem()}),$(".itemFavorite").off("click").on("click",a),$(".itemDelete").off("click").on("click",o)},o=function(){console.log("delete");var e=$(this).parent();t.forEach(function(i,n){i.view.item[0]===e[0]&&t[n].model.remove(n)})},a=function(){console.log("favToggle");var e=$(this).parent();t.forEach(function(i,n){i.view.item[0]===e[0]&&t[n].model.update(n)})},s=function(){console.log("adding new item");var t=$("#itemInput").val();t.length>0?(new l(t).add(),$("#itemInput").val(""),d()):alert("You haven't write anything!")},d=function(){console.info("rendering simpleTODO"),$("#itemsContainer").empty(),t.forEach(function(t,e){t.model.render(e)}),n()},l=function(i){return this.item={title:i,fav:!1},this.add=function(){e.model=this,new c(this).add()},this.render=function(e){t[e].view.render()},this.update=function(e){this.item.fav=!this.item.fav,t[e].view.update()},this.remove=function(e){t[e].view.remove(),t.splice(e,1)},this},c=function(i){return this.item=null,this.add=function(){{var n=$("<div></div>").addClass("item").hide();$("<span>&#10084;</span>").addClass("itemFavorite").appendTo(n),$("<span></span>").addClass("itemTitle").html(i.item.title).appendTo(n),$("<span>&times;</span>").addClass("itemDelete").appendTo(n)}this.item=n,e.view=this,t.unshift(e),e={}},this.update=function(){this.item.children(".itemFavorite").toggleClass("fav")},this.render=function(){$("#itemsContainer").append(this.item),this.item.fadeIn()},this.remove=function(){this.item.fadeOut()},this},f=function(){console.info("appT init"),d()};return{init:f,items:t,addNewItem:s,favItem:a,deleteItem:o,render:d,storage:i}}(),$(window).on("load",app.todo.init);